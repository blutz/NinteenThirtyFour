{"version":3,"file":"floating-toc/view.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,MAAM,GAAG,GAAG;AAClB,SAASC,UAAUA,CAACC,SAAS,EAAE;EAC7B,MAAMC,OAAO,GAAGD,SAAS,CAACE,gBAAgB,CAAC,GAAG,CAAC;EAC/C,MAAMC,MAAM,GAAGC,KAAK,CAACC,IAAI,CAACJ,OAAO,CAAC,CAACK,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC,CAAC;EAEhER,OAAO,CAACS,OAAO,CAACH,CAAC,IAAI;IACnBA,CAAC,CAACI,gBAAgB,CAAC,OAAO,EAAGC,CAAC,IAAK;MACjCA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClBC,MAAM,CAACC,OAAO,CAACC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,EAAET,CAAC,CAACC,IAAI,CAAC;MACxC,MAAMS,EAAE,GAAGC,QAAQ,CAACC,cAAc,CAACZ,CAAC,CAACC,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC,CAAC;MACvDK,MAAM,CAACM,QAAQ,CAAC;QACdC,GAAG,EAAEJ,EAAE,CAACK,SAAS,GAAGxB,MAAM;QAC1ByB,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,SAASC,YAAYA,CAACC,KAAK,EAAE;IAC3B,MAAMC,CAAC,GAAID,KAAK,GAAG,CAAC,GAAI,CAAC,GAAGA,KAAK;IACjCxB,OAAO,CAACS,OAAO,CAACH,CAAC,IAAIA,CAAC,CAACoB,SAAS,CAACC,MAAM,CAAC,UAAU,CAAC,CAAC;IACpD3B,OAAO,CAACyB,CAAC,CAAC,CAACC,SAAS,CAACE,GAAG,CAAC,UAAU,CAAC;EACtC;EAEAf,MAAM,CAACH,gBAAgB,CAAC,QAAQ,EAAE,MAAM;IACtC,MAAMmB,SAAS,GAAG3B,MAAM,CAACG,GAAG,CAACyB,CAAC,IAAIb,QAAQ,CAACC,cAAc,CAACY,CAAC,CAAC,CAACT,SAAS,CAAC;IACvE,MAAMG,KAAK,GAAGK,SAAS,CAACE,aAAa,CAACC,CAAC,IAAIA,CAAC,IAAKnB,MAAM,CAACoB,OAAO,GAAGpC,MAAO,CAAC;IAC1E0B,YAAY,CAACC,KAAK,CAAC;EACrB,CAAC,CAAC;AACJ;AAEAP,QAAQ,CAACP,gBAAgB,CAAC,kBAAkB,EAAE,MAAM;EAClDO,QAAQ,CAAChB,gBAAgB,CAAC,gCAAgC,CAAC,CAACQ,OAAO,CAACX,UAAU,CAAC;AACjF,CAAC,CAAC,C","sources":["webpack://unicamp-blocks/./src/floating-toc/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end \n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any \n * JavaScript running in the front-end, then you should delete this file and remove \n * the `viewScript` property from `block.json`. \n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\nconst MARGIN = 100\nfunction setupBlock(container) {\n  const anchors = container.querySelectorAll('a')\n  const hashes = Array.from(anchors).map(a => a.hash.substring(1))\n\n  anchors.forEach(a => {\n    a.addEventListener('click', (e) => {\n      e.preventDefault()\n      window.history.pushState({}, '', a.hash)\n      const el = document.getElementById(a.hash.substring(1))\n      window.scrollTo({\n        top: el.offsetTop - MARGIN,\n        behavior: 'smooth',\n      })\n    })\n  })\n\n  function showSelected(index) {\n    const i = (index < 0) ? 0 : index\n    anchors.forEach(a => a.classList.remove('selected'))\n    anchors[i].classList.add('selected')\n  }\n\n  window.addEventListener('scroll', () => {\n    const positions = hashes.map(h => document.getElementById(h).offsetTop)\n    const index = positions.findLastIndex(p => p <= (window.scrollY + MARGIN))\n    showSelected(index)\n  })\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.querySelectorAll('.wp-block-unicamp-floating-toc').forEach(setupBlock)\n})\n"],"names":["MARGIN","setupBlock","container","anchors","querySelectorAll","hashes","Array","from","map","a","hash","substring","forEach","addEventListener","e","preventDefault","window","history","pushState","el","document","getElementById","scrollTo","top","offsetTop","behavior","showSelected","index","i","classList","remove","add","positions","h","findLastIndex","p","scrollY"],"sourceRoot":""}